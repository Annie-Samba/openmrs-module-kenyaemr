<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>

	<style type="text/css">
		table.hei {
		border-collapse: collapse;
		background-color: #fff0f7;
		}
		table.hei > tbody > tr > td, table.hei > tbody > tr > th {
		border: 1px solid black;
		vertical-align: baseline;
		padding: 4px;
		text-align: left;
		}
		.no-close .ui-dialog-titlebar-close {
			display: none;
		}
		.obs-field {
			margin: 0 25px 0px 5px;
		}
		
		input[type='text'], select {
			margin: 0 0 5px 0;
		}
		
		input[type='radio'] {
			margin: 0 0 15px 0;
		}
		
		select:disabled {
		    background-color: #ebebe4;
		}

	</style>
	<script type="text/javascript">
			var jq = jq || jQuery.noConflict();
			var birthdate = new Date("<lookup expression="patient.birthdate" />");
			var patientId = <lookup expression="patient.patientId"/>;
			var encDate = new Date();
			var heiId = '<lookup expression="patient.getPatientIdentifier(7)"/>';

			const YES_CONCEPT_ID = 1065;
			const NO_CONCEPT_ID = 1066;
			const EXPOSURE_TO_HIV_ID = 822;
			const SPECIAL_CARE = 161628;
			const UNKOWN = 1067;
			const OTHER_CONCEPT_ID = 5622;

			function onTransferStatusChange() {
				if (getValue('transfer-status.value') == NO_CONCEPT_ID) {
					jq('#transfer-details :input').attr('disabled', true);
				}
				else if (getValue('transfer-status.value') == YES_CONCEPT_ID) {
					jq('#transfer-details :input').attr('disabled', false);
				}
				else {
					jq('#transfer-details :input').attr('disabled', true);
				}
			}

		    function getCohort(){
				var month = new String(birthdate.getMonth()+1);
					if(month.length == 1) {
						month = '0'+month;
						var cohort = month +"-"+ (birthdate.getUTCFullYear());
						jq('#calculated-cohort').html(cohort);
					}
					else {
						var cohort = month +"-"+ (birthdate.getUTCFullYear());
						jq('#calculated-cohort').html(cohort);
					}
			}

			function tbContactInHouseHold(){
				if (getValue('tbcontact.value') == NO_CONCEPT_ID) {
				jq('#yesTbContact').hide();
				}
				else if (getValue('tbcontact.value') == YES_CONCEPT_ID) {
					jq('#yesTbContact').show();
				}
				else {
					jq('#yesTbContact').hide();
				}
			}

			function pmtctDrugsForMother(){
				if (getValue('pmtct-drugs-received.value') == NO_CONCEPT_ID) {
					jq('#pmtct-regimen').find('input').attr('disabled', true);
				}
				else if (getValue('pmtct-drugs-received.value') == YES_CONCEPT_ID) {
					jq('#pmtct-regimen').find('input').attr('disabled', false);
				}
				else {
					jq('#pmtct-regimen').find('input').attr('disabled', true);
				}
			}

			function onARTatEnrollment(){
				if (getValue('mother-on-art-at-infant-enrolment.value') == NO_CONCEPT_ID) {
					getField('mother-art-regimen-at-infant-enrolment.value').attr('disabled', true);
				}
				else if (getValue('mother-on-art-at-infant-enrolment.value') == YES_CONCEPT_ID) {
					getField('mother-art-regimen-at-infant-enrolment.value').attr('disabled', false);
				}
				else {
					getField('mother-art-regimen-at-infant-enrolment.value').attr('disabled', true);
				}
			}

			function needSpecialCare(){
				if (getValue('special-care.value') == NO_CONCEPT_ID) {
					jq('#reasons-for-special-care').find('input').attr('disabled', true);
				}
				else if (getValue('special-care.value') == SPECIAL_CARE) {
					jq('#reasons-for-special-care').find('input').attr('disabled', false);
				}
				else {
					jq('#reasons-for-special-care').find('input').attr('disabled', true);
				}
			}

			var OPENMRS_CONTEXT_PATH = OPENMRS_CONTEXT_PATH || "kenyaemr";
			function includeMothersNames() {
				jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/patient/patientUtils/getMothers.action',{ patientId: patientId },function(data) {
					var motherName;
					var personId = "";
					for ( var p in data){
						motherName = data[p].name;
						personId = data[p].id;
					}
					jq('#mother-name-list').html(motherName);

					//get telephone contact
					if (personId != "") {
						jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/emrUtils/getPersonTelephoneContact.action',{ personId: personId },function(dt) {
							jq('#mother-telephone-contact').html(dt.telephoneContact);
						});
					}
				});
			}

			function includeFathersNames() {
				jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/patient/patientUtils/getFathers.action',{ patientId: 12458 },function(data) {
					var fatherName;
					var personId = "";
					for ( var p in data){
						fatherName = data[p].name;
						personId = data[p].id;
					}
					jq('#father-name-list').html(fatherName);

					//get telephone contact
					if (personId != "") {
						jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/emrUtils/getPersonTelephoneContact.action',{ personId: personId },function(dt) {
							jq('#father-telephone-contact').html(dt.telephoneContact);
						});
					}
				});
			}

			function includeGuardiansNames() {
				jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/patient/patientUtils/getGuardians.action',{ patientId: patientId },function(data) {
					var guardianName;
					var personId = "";
					for ( var p in data){
						guardianName = data[p].name;
						personId = data[p].id;
					}
					jq('#guardian-name-list').html(guardianName);

					//get telephone contact
					if (personId != "") {
						jq.getJSON('/' + OPENMRS_CONTEXT_PATH +  '/kenyaemr/emrUtils/getPersonTelephoneContact.action',{ personId: personId },function(dt) {
							jq('#guardian-telephone-contact').html(dt.telephoneContact);
						});
					}
				});
			}

			function heiInfants() {

				if (getValue('hiv-exposed-child.value') == '') {
					jq('.hei-section').find('input, select').attr('disabled', true);
				}

				if (getValue('hiv-exposed-child.value') == EXPOSURE_TO_HIV_ID) {
					jq('.hei-section').find('input, select').attr('disabled', false);
				}

				if (getValue('hiv-exposed-child.value') == NO_CONCEPT_ID || getValue('hiv-exposed-child.value') == UNKOWN) {
					jq('.hei-section').find('input, select').attr('disabled', true);
				}
			}
			
			var validAlphanumericEntry = function (str) {
				if (str == '') {
					return true;
				}

				let regexString = /^[a-z0-9]+$/gi;
				return regexString.test(str);				
			}

			var validNumericEntry = function (str) {
				if (str == '') {
					return true;
				}

				let regexString = /^[0-9]+$/gi;
				return regexString.test(str);	
			}

			var validCWCNumber = function (str) {
				if (str == '') {
					return false;
				}

				let regexString = /^CWC-[0-9]{3,5}-[0-9]{3,7}$/gi;
				return regexString.test(str);	
			}
			var showHideSpecifyField = function($selectField) {
				if ($selectField.parents(':first').is('span')) {					
					var $specifyField = $selectField.parents(':first').siblings('.specify').find('input');

					if ($selectField.val() == OTHER_CONCEPT_ID) {
						$specifyField.attr('disabled', false).show().css({'display':'block'});
					} else {
						$specifyField.attr('disabled', true).hide().css({'display':'none'});
					}
				}

			}	

			var includeFacilitiesSearch = function() {
				getField('health-facility-name.value').autocomplete({
					source: function(request, response) {
						jq.ajax({
							url: '/' + OPENMRS_CONTEXT_PATH + '/kenyaemr/search/locations.action',
							dataType: 'json',
							data: {
								q: request.term
							},
							success: function(data) {
								var facilities = [];
								jq.each(data, function(i, o) {
									facilities.push(o.name + ' (' + o.code + ')')
								});
								response(facilities);
							}
						});
					},
					minLength: 2,
					select: function() {
						getField('health-facility-name.value').change();
					}
				});
			};

			/*
			**This is a hack. I realized that if &lt;patient&gt; tags aren't positioned sequentially then an exception is thrown 
			**'(org.openmrs.module.htmlformentry.element.PatientDetailSubmissionElement.getIdentifierType(PatientDetailSubmissionElement.java:448))'
			**The trick is to place a hidden identifier field in question((HEI Id)) next to the other identifier fields. 
			**Then put a placeholder text field where the actual identifier field is supposed to be. ("#hidden-hei-id-placeholder")
			**Then update the hidden field programmatically with the value updated on the placeholder text field
			**/
			var handleHeiId = function () {
				var $heiPlaceholder = jq('#hei-id-placeholder');
				var $hiddenHeiIdPlaceholder = jq('#hidden-hei-id-placeholder');
				$hiddenHeiIdPlaceholder.css({'display':'none'});
				$heiPlaceholder.val(heiId);
				//$heiPlaceholder.on('change blur keyup keypress', function() {
				$heiPlaceholder.change(function() {
					var $that = jq(this);
					$hiddenHeiIdPlaceholder.find('input:first').val($that.val());
				});	
			};


		jq(function() {
			//get cohort
			getCohort();
			jq('#child-status-required').hide();
			//validate transfer in details
			onTransferStatusChange()
			jq('#transfer-status input').click(onTransferStatusChange);
			tbContactInHouseHold();
			jq('#tbcontact input').click(tbContactInHouseHold);
			pmtctDrugsForMother();
			jq('#pmtct-drugs-received input').click(pmtctDrugsForMother);
			onARTatEnrollment();
			jq('#mother-on-art-at-infant-enrolment input').click(onARTatEnrollment);
			needSpecialCare();
			jq('#special-care input').click(needSpecialCare);

			//including the mother details
			includeMothersNames();

			//include the father details if any
			includeFathersNames();

			//include the Guardian's details if any
			includeGuardiansNames();

			//Enable facility autocomplete search capability
			includeFacilitiesSearch();

			//disable arv prophylaxis when a child is NOT exposed and enable whenever they are exposed		
			heiInfants(); 
			jq('#hiv-exposed-child input').click(function() {
				if (jq(this).val() == EXPOSURE_TO_HIV_ID) {
					 heiInfants();
					 pmtctDrugsForMother();
					 onARTatEnrollment();
				 } else {
					 //pmtctDrugsForMother();
					 //onARTatEnrollment();
					 heiInfants();				 	
				 }
			 });

			//Show/hide the 'specify' field when 'other' is selected
			showHideSpecifyField(getField('place-of-delivery.value'));
			getField('place-of-delivery.value').change(function() {
				showHideSpecifyField(jq(this));
			});

			//Activate the handling of HEI ID identifier. Check comments on this function for more details
			handleHeiId();

			beforeSubmit.push(function() {
				var valid = true;

				if (!validAlphanumericEntry(getValue('birth-notification-number.value'))) {
					getField('birth-notification-number.error').html('Birth Notification number only accepts alphanumeric values').show();
					valid = false;
				}

				if (!validAlphanumericEntry(getValue('birth-certificate-number.value'))) {
					getField('birth-certificate-number.error').html('Birth certificate number only accepts alphanumeric values').show();
					valid = false;
				}

				if (!validAlphanumericEntry(jq('nupi').find('input').val())) {
					jq('nupi').find('.error').html('National Unique Patient Identifier only accepts alphanumeric values').show();
					valid = false;
				}	

				if (!validCWCNumber(jq('#cwc-number').find('input').val())) {
					jq('#cwc-number').find('.error').html('Invalid CWC Number').show();
					valid = false;
				}				

				if (!validAlphanumericEntry(jq('permanent-register-number.value').find('input').val())) {
					jq('permanent-register-number').find('.error').html('Permanent Register Number only accepts alphanumeric values').show();
					valid = false;
				}

				if (!validNumericEntry(getValue('community-health-worker-contact.value'))) {
					getField('community-health-worker-contact.error').find('.error').html('Community health worker\'s telephone number accepts numeric values only').show();
					valid = false;
				}				

				if (!validAlphanumericEntry(getValue('mother-ccc-no.value'))) {
					getField('mother-ccc-no.error').html('Mother ccc number only accepts alphanumeric values').show();
					valid = false;
				}

				if (getValue('hiv-exposed-child.value') == "") {
					//jq('#child-status-required').show();
					//jq('#child-status-required').html('Please specify the condition of the child');
					getField('hiv-exposed-child.error').html('Please specify the condition of the child').show();
					valid = false;
				}
				if (getValue('hiv-exposed-child.value') == EXPOSURE_TO_HIV_ID &amp;&amp; jq('#hei-id :input').val() == "") {
					//jq('#child-status-required').show();
					//jq('#child-status-required').html('HEI Unique Number Required');
					jq('#hei-id').find('.error').html('HEI Unique Number Required').show();
					valid = false;
				}

				if (getField('pmtct-drugs-received.value').val() == YES_CONCEPT_ID ) {
					if (getField('pmtct-regimen.value').val() == '') {
						getField('pmtct-regimen.error').html('Enter mother\'s PMCT regimen').show();
						valid = false;
					}
				}

				if (getField('mother-on-art-at-infant-enrolment.value').val() == YES_CONCEPT_ID ) {
					if (getField('mother-art-regimen-at-infant-enrolment.value').val() == '') {
						getField('mother-art-regimen-at-infant-enrolment.error').html('Enter mother\'s ART regimen').show();
						valid = false;
					}
				}

		        return valid;
			});
		});
	</script>

  <div class="ke-form-header">
    <table style="width: 100%">
      <tr>
        <td>
          Enrollment date: <encounterDate id="encounter-date" showTime="true" />
        </td>
        <td>
          Enrolled at: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" />
        </td>
      </tr>
    </table>
  </div>

  <div class="ke-form-content">
    <table class="hei" align="center">
      <tbody>
        <tr>
          <td colspan="3" style="background-color: #696969; color: #ffffff; text-align:center;">
            Mch Child Enrolment Form
          </td>
        </tr>

        <tr>
          <td colspan="3">
            Cohort by month and year of Birth:   MM-YYYY
            <span id="calculated-cohort" class="value"></span>
          </td>
        </tr>
        <tr>
          <td colspan="3" style="background-color: #696969; color: #ffffff;">
            SECTION I
          </td>
        </tr>
        <tr>
          <td valign="top">Particulars of the child </td>
          <td colspan="2">
            <table border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td>Date first seen</td>
                <td>
                  <obs conceptId="162140AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" showTime="false"/>
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td>Gestation at birth(weeks)</td>
                <td>
                  <obs conceptId="1409AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="gestation-at-birth"/>
                </td>
                <td>Birth Weight: (kg)</td>
                <td>
                  <obs conceptId="5916AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="birth-weight"/>
                </td>
                <td>Birth length in cm </td>
                <td>
                  <obs conceptId="1503AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="birth-length"/>
                </td>
              </tr>
              <tr>
                <td>Birth Order in Family (1,2,3) </td>
                <td>
                  <obs conceptId="163460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="birth-order"/>
                </td>
                <td>Birth type: </td>
                <td>
                  <obs conceptId="159949AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="159913AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159914AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159915AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113450AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Single,Twins,Triplets,Quadruplets,Quintuplets" style="dropdown" id="birth-type"/>
                </td>
                <td>Place of delivery</td>
                <td>
                  <obs conceptId="1572AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1589AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Facility,Home,Other" style="dropdown" id="place-of-delivery"/> If Other, specify
				  <obs conceptId="163531" class="specify" id="specify-place-of-delivery"/>
                </td>
              </tr>
              <tr>
                <td>Mode of Delivery  </td>
                <td>
                  <obs conceptId="5630AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1170AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1171AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="SVD,C-Section" style="dropdown"/>
                </td>
                <td colspan="4"></td>
              </tr>
            </table>
          </td>
        </tr>

        <tr>
          <td valign="top">Registration Details </td>
          <td colspan="2">
            <table border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td>Birth Notification Number <obs conceptId="162051AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="birth-notification-number"/></td>
                <td>Date Issued  <obs conceptId="164129AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="date-issued"/> </td>
                <td></td>
              </tr>
              <tr>
                <td>Birth certificate Number <obs conceptId="162052AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="birth-certificate-number"/></td>
                <td>Date of registration <obs conceptId="164130AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="date-of-registration"/></td>
                <td>Place of registration <obs conceptId="164140AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />                </td>
              </tr>
              <tr>
                <td>Health facility name:  <obs conceptId="162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="health-facility-name"/></td>
                <td>Patient Clinic No. <patient field="identifier" identifierTypeId="b4d66522-11fc-45c7-83e3-39a1af21ae0d" required="true" id="patient-clinic-no"/></td>
                <td></td>
              </tr>
              <tr>
                <td colspan="3">
					<table border="0" cellspacing="3" cellpadding="0">
					  <tr>
						<td>
							CWC No <br />
							<span style="font-size:70%"><em>Format:(CWC-MFLCode-SerialNo)</em> <br />
							<strong><em>e.g CWC-15007-00001</em></strong></span>					
						</td>
						<td>
							<span id="cwc-number">
								<patient field="identifier" identifierTypeId="1dc8b419-35f2-4316-8d68-135f0689859b" required="true"/>
							</span>
						</td>
						<td>Permanent Register Number</td>
						<td>
							<span id="permanent-register-number">
								<patient field="identifier" identifierTypeId="a8a046d6-c53e-490f-bc76-196c4010ba7d" required="true"/>
							</span>
							<span id="hidden-hei-id-placeholder">
								HEI ID: <patient field="identifier" identifierTypeId="0691f522-dd67-4eeb-92c8-af5083baf338" required="true"/>
							</span>
						</td>
					  </tr>
					</table>
                  </td>
              </tr>
              <tr>
                <td colspan="2">
                	<span id="nupi">
                  		National Unique Patient Identifier <patient field="identifier" identifierTypeId="f85081e2-b4be-4e48-b3a4-7994b69bb101" required="true"/>   
                 	</span>
                </td>
                <td></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td valign="top">Contact details </td>
          <td colspan="2">
            <table border="0" cellspacing="0" cellpadding="0">
			 <tr>
			 	<td colspan="3">
			 		<strong>
						<em style="
						    text-decoration: underline;
						    border-bottom: 1px dotted #000000;
						">Please use the 'Relationship Page' to manage parents and guardians</em>			 			
			 		</strong>
			 	</td>
			  </tr>
              <tr>
                <td>Father's Name:  </td>
                <td><span id="father-name-list" class="value"></span></td>
                <td>Tel No <span id="father-telephone-contact" class="value"></span></td>
              </tr>
              <tr>
                <td>Mother's Name </td>
                <td><span id="mother-name-list" class="value"></span></td>
                <td>Tel No <span id="mother-telephone-contact" class="value"></span></td>
              </tr>
              <tr>
                <td>Guardian's Name </td>
                <td><span id="guardian-name-list" class="value"></span></td>
                <td>Tel No <span id="guardian-telephone-contact" class="value"></span></td>
              </tr>
              <tr>
                <td colspan="2">Community Health Worker's Name
                  <obs conceptId="164141AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="community-health-worker-name" placeholder="Surname FirstName OtherNames"/></td>
                
                <td>
                	Tel No.
                	<obs conceptId="159635AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="community-health-worker-contact" />                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td>Special Care </td>
          <td colspan="2">
            <table>
              <tbody>
                <tr>
                  <th colpan="2">
                    Does the child need special care?
                    <obs conceptId="161630AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="161628AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" id="special-care"/>
                  </th>
                </tr>
                <tr>
                  <th colpan="2">
                    Reasons For  Special Care(<i>Tick as appropriate</i>)
                  </th>
                </tr>
                <tr id="reasons-for-special-care">
                  <td>
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="116222AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Birth weight less than 2.5 kg" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162071AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Birth less than 2 years after last birth" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162072AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Fifth or more child" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162073AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Teenage mother" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Brother or sisters undernourished" style="checkbox" />
                  </td>
                  <td>
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162075AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Multiple births(Twins,triplets)" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162076AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Child in family dead" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1174AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Orphan" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="161599AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Child has disability" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1859AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Parent HIV positive" style="checkbox" />
                    <br />
                    <obs conceptId="161601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="123174AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="History/signs of child abuse/neglect" style="checkbox" />
                  </td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
        <tr>
          <td>Exposure History </td>
          <td colspan="2">
            HIV Exposed Child?
            <obs conceptId="5303AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="822AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No,Unknown" id="hiv-exposed-child" style="radio" /><br />
            <div id="child-status-required" class="error"></div>
          </td>
        </tr>
          <tr>
            <td colspan="3" style="background-color: #696969; color: #ffffff;">
              SECTION II
            </td>
          </tr>
          <tr class="hei-section">
            <td>HEI Registration </td>
            <td colspan="2">
              <table>
                <tr>
                  <td>HEI ID Number</td>
                  <td>
                    <span id="hei-id">
						<ifMode mode="EDIT">
							<input type="text" id="hei-id-placeholder" />
						</ifMode>

						<ifMode mode="ENTER">
							<input type="text" id="hei-id-placeholder" />
						</ifMode>

						<ifMode mode="VIEW">
							<span class="value"><lookup expression="patient.getPatientIdentifier(7)"/></span>
						</ifMode>
						<span class="error field-error" style="display: none" id="hei-place-holder-error"></span>
                    </span>
                  </td>
                  <td>SPD No</td>
                  <td id="spd">
                    <obs conceptId="162054AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          <tr class="hei-section">
            <td>Referral details </td>
            <td colspan="2">
              <table>
                <tr>
                  <td>
                    Source of Referral
                    <obs style="radio" answerSeparator=" "
                     conceptId="160540AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                     answerConceptIds="160537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160542AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160456AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162050AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160538AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                     answerLabels="Paediatric,OPD,Maternity,CCC,MCH/PMTCT,Other"
								/>
                  </td>
                </tr>
                <tr>
                  <td>
                    Transfer in?

                    <obs id="transfer-status" conceptId="160563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"
                    answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                    answerLabels="Yes,No"	/>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div id="transfer-details">
                      <table>
                        <tr>
                          <td>Transfer in date:</td>
                          <td>
                            <obs conceptId="160534AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                          </td>
                          <td>Transferred from facility:</td>
                          <td>
                            <obs conceptId="160535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                          </td>
                        </tr>
                        <tr>
                          <td>in district:</td>
                          <td>
                            <obs conceptId="161551AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                          </td>
                          <td>
                            Date <i>first</i> enrolled in HEI care:
                          </td>
                          <td>
                            <obs conceptId="160555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                          </td>
                        </tr>
                      </table>
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          <tr id="arv-prophylaxis" class="hei-section">
            <td valign="top">Child ARV Prophylaxis</td>
            <obsgroup groupingConceptId="1638AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
              <td colspan="2">
                <table border="0" cellspacing="0" cellpadding="0">

                  <tr>
                    <td colspan="3">Type of ARV prophylaxis
                    <obs conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
       answerLabels="Sd NVP Only,sd NVP+AZT+3TC,NVP for 6 weeks(Mother on HAART),None,Other" style="radio" id="type-of-arv-prophylaxis"/>                    </td>
                  </tr>
                  <tr>
                    <td colspan="4">Is the mother Breastfeeding? 
                    <obs conceptId="159941AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159941AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No,Unknown" style="radio" id="mother-breastfeeding"/>                    </td>
                  </tr>
                  <tr>
                    <td colspan="2">NVP during BF?
                    <obs conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" answerConceptId="80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel=""/>                    </td>
                    <td colspan="2">History of TB Contact in Household?
                      <obs conceptId="152460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" id="tbcontact"/>                    </td>
                  </tr>
                  <tr>
                    <td colspan="2"></td>
                    <td>
                      <span id="yesTbContact" class="value">Screen for TB; and appropriately refer for INH Prophylaxis</span></td>
                  </tr>
                </table>
              </td>
            </obsgroup>
          </tr>
          <tr class="hei-section">
            <td>Mother's ARV profile </td>
            <td colspan="2">
              <table border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td colspan="2">Mother Alive? 
                    <obs conceptId="160429AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  style="yes_no" id="mother-alive"/>                  </td>
                  <td colspan="2"></td>
                </tr>
                  <tr>
                    <td colspan="2">Mother received Drugs for PMTCT?
                      <obs conceptId="1148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" id="pmtct-drugs-received"/></td>
                    <td colspan="2">If yes, select regimen
                    <obs conceptId="1086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                         answerLabels="Sd NVP Only,AZT+NVP+3TC,HAART,Other" style="radio" id="pmtct-regimen"/></td>
                  </tr>
                  <tr>
                    <td colspan="2">Mother On ART at Enrollment of Infant	
                    <obs conceptId="162055AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" id="mother-on-art-at-infant-enrolment"/>                    </td>
                    <td colspan="2">If yes enter regimen 
                    <obs conceptId="1088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                       answerConceptIds="160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5424AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5811AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                       answerLabels="AZT+3TC+EFV,AZT+3TC+NVP,D4T+3TC+NVP,D4T+3TC+EFV,TDF+3TC+EFV,TDF+3TC+NVP,AZT+3TC+LPV/r,TDF+3TC+LPV/r,Other,Unknown" id="mother-art-regimen-at-infant-enrolment"/>                    </td>
                  </tr>
                  <tr>
                    <td colspan="2">
                      Mother's CCC No. <obs conceptId="162053AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" size="15" id="mother-ccc-no"/>                    </td>
                    <td colspan="2"></td>
                  </tr>
              </table>
            </td>
          </tr>
        <enrollInProgram programId="c2ecdf11-97cd-432a-a971-cfd9bd296b83"/>
      </tbody>
    </table>
  </div>
  <div class="ke-form-footer">
    <submit />
  </div>
</htmlform>